<html>
<head>
    <meta charset="utf-8"/>
<meta name="description" content=""/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>uni-app自定义TabBar | kaobeimao</title>
<link rel="shortcut icon" href="https://kaobeimao.github.io/favicon.ico?v=1590055263099">
<link href="https://cdn.bootcss.com/font-awesome/5.11.2/css/all.css" rel="stylesheet">
<link rel="stylesheet" href="https://kaobeimao.github.io/styles/main.css">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

<script src="https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/go.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>

<!-- DEMO JS -->
<!--<script src="media/scripts/index.js"></script>-->



    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/images/avatar.png" alt="头像">
        <div class="site-name gt-c-content-color-first">
            kaobeimao
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
                <div class="nav-item">
                    
                        <a href="/" class="menu gt-a-link">
                            首页
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/archives" class="menu gt-a-link">
                            归档
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/tags" class="menu gt-a-link">
                            标签
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/post/about" class="menu gt-a-link">
                            关于
                        </a>
                    
                </div>
            
        </div>
    </div>
</nav>
    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    uni-app自定义TabBar
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        · 2019-10-27 ·
                    </time>
                    
                        <a href="https://kaobeimao.github.io/tag/e72YuKUCI/" class="post-tags">
                            # vue
                        </a>
                    
                        <a href="https://kaobeimao.github.io/tag/1pfcsHdmN/" class="post-tags">
                            # 小程序
                        </a>
                    
                        <a href="https://kaobeimao.github.io/tag/n0e37Om65/" class="post-tags">
                            # note
                        </a>
                    
                </div>
                <div class="post-content">
                    <h3 id="vuex管理状态">Vuex管理状态</h3>
<pre><code class="language-js">// state.js
export default {
    currentTabBarIndex: 0,
    myTabBar: [],
    operatorTabBar: [
        {
            &quot;pagePath&quot;: &quot;xxx&quot;,
            &quot;text&quot;: &quot;xxx&quot;,
            &quot;iconPath&quot;: &quot;xxx&quot;,
            &quot;selectedIconPath&quot;: &quot;xxx&quot;
        },
        {
            &quot;pagePath&quot;: &quot;xxx&quot;,
            &quot;text&quot;: &quot;xxx&quot;,
            &quot;iconPath&quot;: &quot;xxx&quot;,
            &quot;selectedIconPath&quot;: &quot;xxx&quot;
        },
        {
            &quot;pagePath&quot;: &quot;xxx&quot;,
            &quot;text&quot;: &quot;xxx&quot;,
            &quot;iconPath&quot;: &quot;xxx&quot;,
            &quot;selectedIconPath&quot;: &quot;xxx&quot;
        },
    ],
    workerTabBar: [
        {
            &quot;pagePath&quot;: &quot;xxx&quot;,
            &quot;text&quot;: &quot;xxx&quot;,
            &quot;iconPath&quot;: &quot;xxx&quot;,
            &quot;selectedIconPath&quot;: &quot;xxx&quot;
        },
        {
            &quot;pagePath&quot;: &quot;xxx&quot;,
            &quot;text&quot;: &quot;xxx&quot;,
            &quot;iconPath&quot;: &quot;xxx&quot;,
            &quot;selectedIconPath&quot;: &quot;xxx&quot;
        },
    ]
}

// mutation-types.js
export const SET_CURRENT_TAB_BAR_INDEX = 'SET_CURRENT_TAB_BAR_INDEX'
export const SET_TAB_BAR = 'SET_TAB_BAR'

// mutation.js
import * as types from './mutation-types'

export default {
    [types.SET_CURRENT_TAB_BAR_INDEX](state, index) {
        state.currentTabBarIndex = index
    },
    [types.SET_TAB_BAR](state, list) {
        state.myTabBar = list
    }
}
</code></pre>
<h3 id="tabbar组件">TabBar组件</h3>
<p>使用cover-view避免小程序canvas层级最高的显示问题</p>
<pre><code class="language-html">&lt;!-- template --&gt;
&lt;template&gt;
    &lt;cover-view class=&quot;footer&quot;&gt;
        &lt;cover-view :class=&quot;'footer_item ' + (currentTabBarIndex === index? 'active' : '')&quot; :style=&quot;'width:'+item_width&quot;
            @click=&quot;setCurrentTabBarIndex(index)&quot; v-for=&quot;(item,index) in myTabBar&quot; :key=&quot;index&quot;&gt;
            &lt;cover-image :src=&quot;index==currentTabBarIndex?item.selectedIconPath:item.iconPath&quot; mode=&quot;&quot;&gt;&lt;/cover-image&gt;
            &lt;cover-view&gt;item.text&lt;/cover-view&gt;
        &lt;/cover-view&gt;
    &lt;/cover-view&gt;
&lt;/template&gt;
</code></pre>
<pre><code class="language-js">// script
import { mapState, mapMutations } from 'vuex'
import * as types from '../../store/mutation-types'

export default {
    data() {
        return {}
    },
    computed: {
        ...mapState(['currentTabBarIndex', 'myTabBar']),
        item_width() {
            const length = this.myTabBar.length
            switch (length) {
                case 1:
                    return '100%'
                    break
                case 2:
                    return '50%'
                    break
                case 3:
                    return '33.3%'
                    break
                case 4:
                    return '25%'
                    break
                case 5:
                    return '20%'
                    break
                default:
                    break
            }
        }
    },
    methods: {
        ...mapMutations({
            setCurrentTabBarIndex: types.SET_CURRENT_TAB_BAR_INDEX
        })
    }
}
</code></pre>
<pre><code class="language-css">&lt;style lang=&quot;scss&quot; scoped&gt;
.footer {
    @include border-top-1px;
    height: 100upx;
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background-color: #ffffff;
    color: #606770;
}
.footer_item {
    float: left;
    text-align: center;
    font-size: 24upx;
    height: 100upx;

    &amp;.active {
        color: #007aff;
    }
}
.footer_item cover-image {
    width: 50upx;
    height: 50upx;
    margin: 6upx auto;
}
&lt;/style&gt;
</code></pre>
<h3 id="layout页面">layout页面</h3>
<p>layout组件作为首页，把想要成为TabBar页面的组件和<strong>TabBar</strong>组件一起引入，使用<strong>v-if</strong>显示隐藏</p>
<pre><code class="language-html">&lt;template&gt;
    &lt;div class=&quot;layout&quot;&gt;
        &lt;xxx v-if=&quot;currentPageName === 'xxx'&quot; /&gt;
        &lt;xxx v-else-if=&quot;currentPageName === 'xxx'&quot; /&gt;
        &lt;xxx v-else-if=&quot;currentPageName === 'xxx'&quot; /&gt;
        &lt;xxx v-else-if=&quot;currentPageName === 'xxx'&quot; /&gt;
        &lt;xxx v-else-if=&quot;currentPageName === 'xxx'&quot; /&gt;
        &lt;xxx v-else-if=&quot;currentPageName === 'xxx'&quot; /&gt;
        &lt;TabBar v-if=&quot;showTabBar&quot; /&gt;
    &lt;/div&gt;
&lt;/template&gt;
</code></pre>
<pre><code class="language-js">import { mapState, mapMutations } from 'vuex'
import * as types from '../../store/mutation-types'
import TabBar from '../../components/tab-bar/TabBar'
import xxx from '../overview/index'
import xxx from '../community/index'
import xxx from '../card/index'
import xxx from '../my/index'
import xxx from '../worker-station-create/index'
import xxx from '../worker-station-list/index'

export default {
    components: {
        TabBar,
        xxx,
        xxx,
        xxx,
        xxx,
        xxx,
        xxx
    },
    data() {
        return {
            showTabBar: false
        }
    },
    computed: {
        ...mapState([
            'currentTabBarIndex',
            'myTabBar',
            'workerTabBar',
            'operatorTabBar'
        ]),
        currentPageName() {
            try {
                if (this.myTabBar.length) {
                    this.checkUser()
                    return this.myTabBar[this.currentTabBarIndex].text
                } else {
                    return ''
                }
            } catch (error) {
                return ''
            }
        }
    },
    onLoad() {
        this.checkUser()
        this.handleShowTabBar()
    },
    methods: {
        ...mapMutations({
            setTabBar: types.SET_TAB_BAR
        }),
        checkUser() {
            const myTabBar = '权限判断' ? 'workerTabBar' : 'operatorTabBar'
            this.setTabBar(this[myTabBar])
        },
        handleShowTabBar() {
            /**
             * ！！！安卓设备问题
             * tabbar延迟加载，防止被canvas覆盖
             */
            setTimeout(() =&gt; {
                this.showTabBar = true
            }, 500)
        }
    }
}
</code></pre>
<pre><code class="language-css">&lt;style lang=&quot;scss&quot; scoped&gt;
.layout {
    text-align: center;
    padding-bottom: 100upx;
}
&lt;/style&gt;
</code></pre>
<h3 id="tabbar页面">TabBar页面</h3>
<p>不能使用onLoad和onShow生命周期，建议使用<strong>mounted</strong>初始化数据</p>

                </div>
            </article>
        </div>

        
            <div class="next-post">
                <div class="next gt-c-content-color-first">下一篇</div>
                <a href="https://kaobeimao.github.io/post/tm-55fOUc/" class="post-title gt-a-link">
                    Electron+ElementUI输入框键盘回车事件白屏
                </a>
            </div>
        

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first">舒服嗷铁汁</div>
    <div class="social-container">
        
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
    <div class="footer-info">
        note
    </div>
    <div>
        Theme by <a href="https://imhanjie.com/" target="_blank">imhanjie</a>, Powered by <a
                href="https://github.com/getgridea/gridea" target="_blank">Gridea | <a href="https://kaobeimao.github.io/atom.xml" target="_blank">RSS</a></a>
    </div>
</div>

<script>
    hljs.initHighlightingOnLoad()
</script>


    </div>
</div>
</body>
</html>
